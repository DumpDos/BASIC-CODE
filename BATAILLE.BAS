80 CLS
81 LOCATE 12,20:PRINT "Un minitel est-il bien branché au PC (O/N)"
82 S$="":WHILE S$="":S$=INKEY$:WEND
83 IF S$="O" OR S$="o" THEN CLS:GOTO 90
84 LOCATE 16,20:PRINT "Faites-le et appuyez sur une touche"
85 WHILE INKEY$="":WEND:CLS:GOTO 81
90 DEF SEG=64:IF (PEEK(23) AND 64)<>64 THEN BEEP:LOCATE 12,20:PRINT "Appuyez sur la touche 'CAPS LOCK'":GOTO 90
100 DEF SEG
110 KEY OFF:DEFINT A-Z
111 PRINT "Fin lancement : CONNEXION AU MINITEL"
120 KEY(10) ON:ON KEY(10) GOSUB 4290
130 '
140 ' BAT(1,0-11,0-11) contien le jeu du joueur-minitel
150 ' BAT(2,0-11,0-11) contien le jeu du joueur-ordinateur
160 '
170 DIM BAT(2,11,11),LETT$(4),CHIF$(4)
180 FOR I=0 TO 11
190   FOR J=0 TO 11
200           BAT(1,I,J)=0:BAT(2,I,J)=0
210   NEXT
220 NEXT
230 '
240 ' Initialisation Minitel
250 '
260 OPEN "com1:1200,e,7,1,cs,ds,cd" AS #1 LEN=2000
270 PRINT #1,CHR$(27)+CHR$(59)+CHR$(96)+"XR"
280 PRINT #1,CHR$(1);"L E"
290 PRINT #1,CHR$(1);"E D"
300 PRINT #1,CHR$(27)+":iC"
310 PRINT #1,CHR$(0)
320 PRINT #1,CHR$(12)
330 CLS
340 GOSUB 2970 ' aff. écran minitel
350 GOSUB 3240 ' aff. écran ordi.
360 GOSUB 4270 ' vidage tampon-clavier Minitel
370 GOSUB 1880 ' création du plateau de jeu
380 GOSUB 4270
390 GOSUB 580 ' jeu
400 GOSUB 4270
410 '
420 ' fin du jeu encore une fois ?
430 '
440 LIG=15:COL=5:GOSUB 3440 ' = LOCATE 15,5 pour Minitel
450 PRINT #1 "ENCORE UNE PARTIE ? (O/N)"
460 LOCATE 15,5:PRINT "ENCORE UNE PARTIE ? (O/N)"
470 LIG=16:COL=15:GOSUB 3440:PRINT #1,".":LIG=16:COL=15:GOSUB 3440
480 GOSUB 4270
490  S$=INPUT$(1,#1)
500 LOCATE 16,15:S2$=INPUT$(1)
510 IF S$=S2$ AND S$="O" THEN 330 ' on rejoue si les 2 joueurs le veulent
520 END
530 '
540      '     ..........................................................
550 ' jeu
560      '     ..........................................................
570
580 FINNIMI=0:FINORDI=0
590 WHILE FINMINI=0 AND FINORDI=0
600   JOUEUR$="mini"
610   WHILE JOUEUR$="mini"
620     GOSUB 930 ' coup mini
630   WEND
640   IF FINMINI=1 THEN 690
650    JOUEUR$="ordi"
660	  WHILE JOUEUR$="ordi"
670     GOSUB 1370 ' coup ordi
680   WEND
690 WEND
700 FOR QQ=1 TP 15000:NEXT
710 CLS:PRINT #1.CHR$(12)
720 IF FINMINI=0 THEN 810
730     CLS:LOCATE 5,18:PRINT "HELAS !":LOCATE 10,14:PRINT "VOUS AVEZ PERDU"
740 	LIG=5:COL=1:GOSUB 3440
750		PRINT #1,CHR$(27);CHR$(79);CHR$(27);CHR$(72);"       BRAVO !    "
760		LIG=10:COL=1:GOSUB 3440
770	 	PRINT #1,CHR$(27);CHR$(79);CHR$(27);CHR$(72);"       VOUS AVEZ GAGNER"
780		PRINT #1,CHR$(27);CHR$(73)
790  RETURN
800 ' ELSE
810		CLS:LOCATE 5,18:PRINT "BRAVO !":LOCATE 10,14:PRINT "VOUS AVEZ GAGNE"
820 	LIG=5:COL=1:GOSUB 3440
830		PRINT #1,CHR$(27);CHR$(79);CHR$(27);CHR$(72);"       HELAS !    "
840		LIG=10:COL=1:GOSUB 3440
850	 	PRINT #1,CHR$(27);CHR$(79);CHR$(27);CHR$(72);"       VOUS AVEZ PERDU"
860		PRINT #1,CHR$(27);CHR$(73)
870  RETURN
880 '
890	     '     ..........................................................
900 ' coup joueur-Minitel
910      '     ..........................................................
920 '
930 LIG=21:COL=1:GOSUB 3440:PRINT #1,CHR$(27)+CHR$(91)+CHR$(74)
940 LIG=21:COL=1:GOSUB 3440
950 PRINT #1,"QUELLE CASE ? ";CHR$(24)
960 COL=10:LIG=22:GOSUB 3440:PRINT #1,".."
970 COL=10:LIG=22:GOSUB 3440
980 GOSUB 4270
990 PLACE$="" ' saisie réponse minitel
1000 ARRET=0
1010 WHILE ARRET=0
1020   GOSUB 3510
1030  WHILE CORREC=1
1040	   PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
1050	   GOSUB 3510
1060  WEND
1070  PLACE$=PLACE$+S$
1080 WEND
1090 PLACE$=LEFT$(PLACE$,2)
1100 OK=0:GOSUB 1760:IF OK=0 THEN PRINT #1,CHR$(7);:GOTO 930
1110 FOR I=20 TO 24:LOCATE I,1:PRINT SPACE$(35);:NEXT
1120 LOCATE 21,1:PRINT "VOTRE ADVERSAIRE JOUE EN ";PLACE$;SPACE$(9);
1130 LOCATE 22,1:PRINT "TOUCHE, COULE, PLOUF ou DEPEU ?"
1140  LOCATE 23,10:¨PRINT SPACE$(10):LOCATE 23,10:INPUT REP$:IF REP$<>"TOUCHE" AND REP$<>"COULE" AND REP$<>"PLOUF" AND REP$<>"DEPEU" THEN 1140
1150 LIG=21:COL=1:GOSUB 3440:PRINT #1,CHR$(27)+CHR$(91)+CHR$(74)
1160 LIG=23:COL=1:GOSUB 3440
1170 PRINT #1,"VOTRE ADVERSAIRE REPOND :";REP$CHR$(24)
1180 P1$=MID$(PLACE$,1,1):P2$=MID$(PLACE$,2,1):BAT(2,ASC(P1$)-64,ASC(P2$)-47)=0
1190 IF REP$="TOUCHE" OR REP$="COULE" THEN LIG=P2+6:COL=P1+25:GOSUB 3440:PRINT #1,"$";:LOCATE P2+6,P1+5:PRINT "@"
1200 IF REP$="DEPEU" THEN LIG=P2+6:COL=P1+25:GOSUB 3440:PRINT #1,"'";
1210 IF REP$="PLOUF" THEN LIG=P2+6:COL=P1+25:GOSUB 3440:PRINT #1,"0";
1220 FOR QQ=1 TO 15000:NEXT
1230 FOR K=0 TO 11
1240  FOR L=0 TO 11
1250   IF BAT(2,K,L)=1 THEN TOT=TOT+1
1260  NEXT
1270 NEXT
1280 IF TOT=0 THEN FINMINI=1 ' fin de partie ?
1290 TOT=0
1300 IF (REP$"TOUCHE" OR REP$="COULE") AND FINMINI=0 THEN JOUEUR$="mini" ELSE JOUEUR$="ordi"
1310 RETURN
1320 '
1330     '     ..........................................................
1340 ' coup joueur-ordinateur
1350     '     ..........................................................
1360 '
1370 FOR I=20 TO 24:LOCATE I,1:PRINT SPACE$(35);:NEXT
1380 LOCATE 21,10
1390 PRINT "QUELLE CASE ? ";SPACE$(20)
1400 LOCATE 22,10:PRINT ".."
1410 LOCATE 22,8
1420 INPUT PLACE$
1430 PLACE$=LEFT$(PLACE$,2)
1440 OK=0:GOSUB 1760:IF OK=0 THEN BEEP:GOTO 1370
1450 LIG=21:COL=1:GOSUB 3440:PRINT #1,CHR$(27)+CHR$(91)+CHR$(74)
1460 LIG=21:COL=1:GOSUB 3440:PRINT #1,"VOTRE ADVERSAIRE JOUE EN ";PLACE$;CHR$(24)
1470 LIG=22:COL=1:GOSUB 3440:PRINT #1,"TOUCHE, COULE, PLOUF ou DEPEU ?";CHR$(24)
1480 LIG=23:COL=10:GOSUB 3440:PRINT #1,"......"
1490 GOSUB 4270
1500 REP$="":LIG=23:COL=10:GOSUB 3440
1510 FOR I=1 TO 5:ANCOR=0:GOSUB 3510
1520  IF ANCOR=1 THEN I=I-1
1530  REP$=REP$+S$
1540 NEXT
1550 IF REP$<> "COULE" AND REP$<>"TOUCHE" AND REP$<>"PLOUF" AND REP$<>"DEPEU" THEN 1480
1560 FOR I=20 TO 24:LOCATE I,1:PRINT SPACE$(35);:NEXT
1570 LOCATE 23,1
1580 PRINT "VOTRE ADVERSAIRE REPOND :";REP$;SPACE$(9)
1590 P1$=MID$(PLACE$,1,1):P2$=MID$(PLACE$,2,1):BAT(1,ASC(P1$)-64,ASC(P2$)-47)=0
1600 IF REP$="TOUCH" OR REP$="COULE" THEN LOCATE P2+6,P1+25:PRINT "$";:LIG=P2+6:COL=P1+5:GOSUB 3440:PRINT #1,"@";
1610 IF REP$="DEPEU" THEN LOCATE P2+6,P1+25:PRINT "'";
1620 IF REP$="PLOUF" THEN LOCATE P2+6,P1+25:PRINT "0";
1630 FOR QQ=1 TO 15000:NEXT
1640 FOR K=0 TO 11
1650  FOR L=0 TO 11
1660   IF BAT(2,K,L)=1 THEN TOT=TOT+1
1670  NEXT
1680 NEXT
1690 IF TOT=0 THEN FINORDI=10
1700 TOT=0
1710 IF (REP$="TOUCHE" OR REP$="COULE") AND FINORDI=0 THEN JOUEUR$="ordi" ELSE JOUEUR$="mini"
1720 RETURN
1730 '
1740 ' vérification coup joué
1750 '
1760 FOR K=1 TO LEN(PLACE$) STEP 2
1770   P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
1780  IF P1$<"A" OR P1$>"J" THEN OK=0:RETURN
1790  IF P2$<"0" OR P2$>"9" THEN OK=0:RETURN
1800 NEXT
1810  P1=ASC(P1$)-64:P2=VAL(P2$)+1
1820 OK=1:RETURN
1830 '
1840     '     ..........................................................
1850 ' création du jeu
1860     '     ..........................................................
1870 '
1880 COL=1:LIG=21:GOSUB 3440
1890 PRINT #1,"Tapez les 4 cases du vaisseau amiral"
1900 COL=10LIG=22:GOSUB 3440:PRINT #1,"........"
1910 COL=10LIG=22:GOSUB 3440
1920 PLACE$="":GOSUB 4270
1930 ARRET=0
1940 WHILE ARRET=0
1950   GOSUB 3510
1960  WHILE CORREC=1
1970   PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
1980   GOSUB 3510
1990  WEND
2000 PLACE$=PLACE$+S$
2010 WEND
2020 PLACE$=LEFT$(PLACE$,8)
2030 JOUEUR$="mini":GOSUB 3620 ' vérification
2040 IF OK=0 THEN PRINT #1,CHR$(7);:GOTO 1880
2050 LOCATE 21,1:PRINT "Tapez les 4 cases du vaisseau amiral"
2060 LOCATE 22,10:PRINT SPACE$(18)
2070 LOCATE 22,10:INPUT PLACE$:PLACE$=LEFT$(PLACE$,8)
2080 JOUEUR$="ordi":GOSUB 3620
2090 IF OK=0 THEN BEEP:GOTO 2050
2100 FOR J=1 TO 2
2110   COL=1:LIG=21:GOSUB 3440
2120    PRINT #1,"Tapez les 3 cases su croiseur";J;CHR$(24)
2130    COL=10:LIG=22:GOSUB 3440:PRINT #1,"......"
2140   COL=10:LIG=22:GOSUB 3440
2150    PLACE$=""
2160   GOSUB 4270
2170   ARRET=0
2180  WHILE ARRET=0
2190     GOSUB 3510
2200    WHILE CORREC=1
2210       PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
2220       GOSUB 3510
2230     WEND
2240     PLACE$=PLACE$+S$
2250   WEND
2260    PLACE$=LEFT$(PLACE$,6)
2270     JOUEUR$="mini":GOSUB 3620 ' vérification
2280    IF OK=0 THEN PRINT #1,CHR$(7):GOTO 2110
2290 NEXT
2300 FOR J=1 TO 2
2310   LOCATE 21,1:PRINT "Tapez les 3 cases du croiseur";J;"    "
2320   LOCATE 22,10:PRINT SPACE$(18)
2330   LOCATE 22,10:INPUT PLACE$:PLACE$=LEFT$(PLACE$,6)
2340   JOUEUR$="ordi":GOSUB 3620
2350  IF OK=0 THEN BEEP:GOTO 2310
2360 NEXT
2370 FOR J=1 TO 3
2380    COL=1:lig=21:GOSUB 3440
2390     PRINT #1,"Tapez les 2 cases du destroyer";J;CHR$(24)
2400     COL=10:LIG=22:GOSUB 3440:PRINT #1,"......"
2410    COL=10:LIG=22:GOSUB 3440
2420   GOSUB 4270
2430    PLACE$=""
2440   ARRET=0
2450   WHILE ARRET=0
2460      GOSUB 3510
2470     WHILE CORREC=1
2480        PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
2490        GOSUB 3510
2500     WEND
2510     PLACE$=PLACE$+S$
2520   WEND
2530   PLACE$=LEFT$(PLACE$,4)
2540   JOUEUR$="mini":GOSUB 3620
2550   IF OK=0 THEN PRINT #1,CHR$(7);:GOTO 2380
2560 NEXT
2570 FOR J=1 TO 3
2580   LOCATE 21,1:PRINT "Tapez les 2 cases du destroyer";J;"     "
2590   LOCATE 22,10:PRINT SPACE$(18)
2600   LOCATE 22,10: INPUT PLACE$:PLACE$=LEFT$(PLACE$,4)
2610   JOUEUR$='ordi":GOSUB 3620
2620  IF OK=0 THEN BEEP:GOTO 2580
2630 NEXT
2640 FOR J=1 TO 4
2650    COL=1:lig=21:GOSUB 3440
2660     PRINT #1,"Tapez les 2 cases du sous-marin";J;CHR$(24)
2670     COL=10:LIG=22:GOSUB 3440:PRINT #1,"......"
2680    COL=10:LIG=22:GOSUB 3440
2690   GOSUB 4270
2700    PLACE$=""
2710   ARRET=0
2720   WHILE ARRET=0
2730      GOSUB 3510
2740     WHILE CORREC=1
2750        PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
2760        GOSUB 3510
2770     WEND
2780     PLACE$=PLACE$+S$
2790   WEND
2800   PLACE$=LEFT$(PLACE$,2)
2810   JOUEUR$="mini":GOSUB 3620
2820   IF OK=0 THEN PRINT #1,CHR$(7);:GOTO 2650
2830 NEXT
2840 FOR J=1 TO 4
2850   LOCATE 21,1:PRINT "Tapez les 2 cases du sous-marin";J;"     "
2860   LOCATE 22,10:PRINT SPACE$(18)
2870   LOCATE 22,10: INPUT PLACE$:PLACE$=LEFT$(PLACE$,2)
2880   JOUEUR$='ordi":GOSUB 3620
2890  IF OK=0 THEN BEEP:GOTO 2850
2900 NEXT
2910 RETURN
2920 '
2930     '     ..........................................................
2940 ' affichage écran minitel
2950     '     ..........................................................
2960 '
2970 PRINT #1,CHR$(12)
2980 LIG=4:COL=5:GOSUB 3440
2990 PRINT #1,"VOS NAVIRES :  CEUX DE L'ENNEMI :"
3000 LIG=18:COL=6:GOSUB 3440:PRINT #1,"ABCDEFGHIJ     ABCDEFGHIJ"
3010 FOR I=0 TO 9
3020  COL=3:LIG=I+7:GOSUB 3440:PRINT #1,I;
3030  COL=23:LIG=I+7:GOSUB 3440:PRINT #1,I;
3040 NEXT
3050 COL=5:LIG=6:GOSUB 3440:PRINT #1,CHR$(14); ' passege mode caractère G1
3060 PRINT #1,"7##########k"
3070 COL=25:LIG=6:GOSUB 3440:PRINT #1,CHR$(14);
3080 PRINT #1,"7##########k"
3090 FOR I=1 TO 10
3100  COL=5:LIG=6+I:GOSUB 3440:PRINT #1,CHR$(14);
3110  PRINT #1,"5        j"
3120  COL=25:LIG=6+I:GOSUB 3440:PRINT #1,CHR$(14);
3130  PRINT #1,"5        j"
3140 NEXT
3150 COL=5:LIG=17:GOSUB 3440:PRINT #1,CHR$(14)
3160 PRINT #1,"  uppppppppppz    uppppppppppz"
3170 PRINT #1,CHR$(15)
3180 RETURN
3190 '
3200     '     ..........................................................
3210 ' affichage écran-ordinateur
3220     '     ..........................................................
3230 '
3240 CLS:WIDTH 40
3250 LOCATE 4,5:PRINT "VOS NAVIRES :  CEUX DE L'ENNEMI"
3260 FOR I=0 TO 9
3270  LOCATE I+7,3:PRINT I;
3280  LOCATE I+7,23:PRINT I;
3290 NEXT
3300 LOCATE 18,6:PRINT "ABCDEFGHIJ     ABCDEFGHIJ"
3310 LOCATE 6,5:PRINT "____________     ____________"
3320 FOR I=1 TO 10
3330  LOCATE I+6,5:PRINT I;
3340  LOCATE I+6,25:PRINT I;
3350 NEXT
3360 LOCATE 17,5:PRINT "____________     ____________"
3370 RETURN
3380 '
3390     '     ..........................................................
3400 ' équip. d'un LOCATE pour MINITEL
3410 '     en entrée, LIG et COL
3420     '     ..........................................................
3430 '
3440 PRINT #1,CHR$(31)+CHR$(LIG+64)+CHR$(COL+64);
3450 RETURN
3460 '
3470     '     ..........................................................
3480 ' gestion des entrées d'un carac. depuis Minitel dans s$
3490     '     ..........................................................
3500 '
3510 S$="":CORREC=0:S$=INPUT$(1,#1)
3520 IF ASC(S$)<>19 THEN 3550
3530  S$=INPUT$(1,#1):IF ASC(S$)=71 THEN CORREC=1:S$="":GOTO 3550
3540  IF ASC(S$)=65 THEN ARRET=1:S$=""
3550 IF CORREC=0 THEN PRINT #1,S$;:RETURN
3560 PRINT #1,CHR$(8);".";CHR$(8);:RETURN
3570 '
3580     '     ..........................................................
3590 ' vérification validité entrée , mise dans TAB
3600     '     ..........................................................
3610 '
3620 OK=0
3630 FOR K=1 TO LEN(PLACE$) STEP 2
3640   P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
3650  IF P1$<"A" OR P1$>"J" THEN OK=0:RETURN
3660  IF P2$<"0" OR P2$>"9" THEN OK=0:RETURN
3670 NEXT
3680 IF JOUEUR$="mini" THEN JOU=1 ELSE JOU=2
3690 '
3700 TOT=0
3710 P1=ASC(LEFT$(PLACE$))-64:P2=VAL(MID$(PLACE$,2,1))+1
3720 P3=ASC(MID$(PLACE$,LEN(PLACE$)-1,1))-64:P4=VAL(RIGHT$(PLACE$,1))+1
3730 P1=P1-1:P2=P2-1:P3=P3+1:P4=P4+1
3740 FOR K=P1 TO P3
3750  FOR L=P2 TO P4
3760   TOT=TOT+BAT(JOU,K,L)
3770  NEXT
3780 NEXT
3790 IF TOT<>0 THEN OK=0:RETURN
3800 ' place libre ?
3810 FOR K=1 TO LEN(PLACE$) STEP 2
3820   P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
3830   P1=ASC(P1$)-64:P2=VAL(P2$)+1
3840  IF BAT(JOU,P1,P2)=1 THEN OK=0:RETURN
3850 NEXT
3860 IF LEN(PLACE$)=2 THEN 4040
3870 ' positionnement valide ?
3880 FOR K=1 TO LEN(PLACE$)-2 STEP 2 ' horizontale
3890   P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
3900   P3$=MID$(PLACE$,K+2,1):P4$=MID$(PLACE$,K+3,1)
3910  IF (P1$=P3$) AND (VAL(P4$)<>(P2$)+1) THEN OK=0:RETURN
3920  IF (P2$=P4$) AND (ASC(P3$)<>(P1$)+1) THEN OK=0:RETURN
3930 NEXT K
3940 FOR K=2 TO LEN(PLACE$) STEP 2 ' verticale
3950  LETT$(.5*k+.5)=MID$(PLACE$,K,1)
3960  CHIF$(.5*k+.5)=MID$(PLACE$,K+1,1)
3970 NEXT K
3980 OK1=0:OK2=0 ' diagonale
3990 FOR K=2 TO LEN(PLACE$)/2
4000  IF LETT$(K)<>LETT$(K-1) THEN OK1=1
4010  IF CHIF$(K)<>CHIF$(K-1) THEN OK2=1
4020 NEXT
4030 IF OK1+OK2=2 THEN OK=0:RETURN
4040 FOR K=1 TO LEN(PLACE$) STEP 2 ' remplissage du tableau BAT
4050   P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
4060   P1=ASC(P1$)-64:P2=VAL(P2$)+1
4070  BAT(JOU,P1,P2)=2
4080 NEXT
4090 ' si correct, affichage à l'écran
4100 FOR K=1 TO LEN(PLACE$) STEP 2
4110    P1$=MID$(PLACE$,K,1):P2$=MID$(PLACE$,K+1,1)
4120    BAT(JOU,ASC(P1$)-64,ASC(P2$)-47)=1
4130    P1=ASC(P1$)-65:P2=VAL(P2$)
4140   IF JOU=1 THEN 4180
4150     LOCATE P2+7:COL=P1+6:PRINT "$";
4160     PRINT #1,"$"
4170   ' ELSE
4180     LIG=P2+7:COL=P1+6:GOSUB 3440
4190      PRINT #1,"$"
4200 NEXT
4210 OK=1:RETURN
4220 '
4230     '     ..........................................................
4240 ' vidage tampon-clavier du Minitel
4250     '     ..........................................................
4260 '
4270 WHILE NOT EOF(1):S$=INPUT$(1,#1):WEND
4280 RETURN
4290 TR=0
4300 FOR II=0 TO 11
4310  FOR JJ=0 TO 11
4320   IF BAT(1,JJ,II)=1 THEN 4360
4330  NEXT
4340 NEXT
4350 RETURN
4360 LOCATE 1,10:PRINT CHR$(64+JJ),II-1;
4370 FOR AA=1 TO 1000:NEXT
4380 LOCATE 1,10:PRINT SPACE$(30);
4390 RETURN
4400 FOR II=0 TO 11
4410 FOR JJ=0 TO 11
4420 PLACE$="":GOSUB 4270
4430 ARRET=0
4440 WHILE ARRET=0
4450  GOSUB 3510
4460 WHILE CORREC=1
4470   PLACE$=LEFT$(PLACE$,LEN(PLACE$)-1)
4480   GOSUB 3510
4490 WEND
4500 PLACE$=PLACE$+S$
4510 WEND
